{% extends "__data_browser__/list.haml" %}
{% block __data_browser__custom_external_block %}
  <script type="text/javascript">
    $(function () {
      {% if request.args.get("user_id") %}
        $("#user").val({{ request.args.get("user_id") }}).trigger("change");
      {% endif %}
      {% if request.args.getlist("create_time") %}
        var create_time_list = {{ request.args.getlist("create_time")|tojson|safe }}
            $("[name=create_time]").each(function (idx, val) {
              $(this).val(create_time_list[idx]);
            });
      {% endif %}
      $("#reset-button").click(function () {
        $("select").select2("val", "");
      });
    });
  </script>
{% endblock %}
{% block lists %}
<div class="span10">
  {% if __data__ %}
    {% for grouper, list in __data__|groupby("create_date")|reverse %}
      <pre class="prettyprint"><strong>{{ grouper }}:</strong></pre>
      {% for log in list %}
        <blockquote>
          {% if log.obj_cls %}
            {% for k, v in log.url_map %}
              <a href="{{ v }}">{{ k }}</a>
            {% endfor %}
          {% else %}
            <span class="{{ "text-error" }}">{{ log.level }}</span>
          {% endif %}
          来自<span class="muted">{{ log.actor or "" }}</span>
          <br>
          <small>{{ log.message }}</small>
        </blockquote>
      {% endfor %}
    {% endfor %}
  {% else %}
    <p class="text-error">{{ _("没有符合条件的结果") }}</p>
  {% endif %}
</div>
{% endblock %}
